!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.Veer=e()}(this,function(){"use strict";function t(t){return"string"==typeof t?document.querySelector(t):t}var e=function(e,i){void 0===i&&(i={});var s=i.itemsToShow;void 0===s&&(s=1);var n=i.itemsToScroll;void 0===n&&(n=1);var o=i.infiniteScroll;void 0===o&&(o=!0);var r=i.centerMode;void 0===r&&(r=!1);var h=i.transitionTime;void 0===h&&(h=500);var c=i.controls;void 0===c&&(c=null);var a=i.dragging;void 0===a&&(a=!0);var d=i.touching;void 0===d&&(d=!0);var l=i.clicking;void 0===l&&(l=!1);var u=i.classes;void 0===u&&(u={active:"is-active",current:"is-current",prev:"is-prev",next:"is-next"}),this.el=t(e),this.settings={itemsToShow:s,itemsToScroll:n,infiniteScroll:o,centerMode:r,transitionTime:h,controls:c,dragging:a,touching:d,clicking:l,classes:u},this.init()};return e.prototype.init=function(){this.items=Array.from(this.el.querySelectorAll(':scope > *:not([class^="veer"])')),this.allItems=this.items,this.itemsCount=this.items.length,this.currentItem=0,this.itemWidth=0,this.clonesAfter=[],this.clonesBefore=[],this.containerWidth=0,this.track=null,this.nextButton=this.el.querySelector(".veer-next"),this.prevButton=this.el.querySelector(".veer-prev"),this.isSliding=!1,this.delta={x:0,y:0},this.initWrapper(),this.settings.infiniteScroll&&this.initClones(),this.settings.controls&&(this.settings.controls.settings.follows=this),this.initEvents(),this.updateWidth()},e.prototype.initWrapper=function(){var t=this,e=document.createDocumentFragment();this.track=document.createElement("div"),this.track.classList.add("veer-track"),this.items.forEach(function(e,i){var s=document.createElement("div");s.classList.add("veer-item"),s.appendChild(e),t.items[i]=s,t.track.appendChild(s)}),e.appendChild(this.track),this.el.appendChild(e)},e.prototype.initClones=function(){var t=this,e=document.createDocumentFragment();this.items.forEach(function(i){var s=i.cloneNode(!0);s.classList.add("veer-clone"),t.clonesAfter.push(s),e.appendChild(s)}),this.track.appendChild(e);var i=document.createDocumentFragment();this.items.forEach(function(e){var s=e.cloneNode(!0);s.classList.add("veer-clone"),t.clonesBefore.push(s),i.appendChild(s)}),this.track.insertBefore(i,this.track.firstChild),this.allItems=this.items.concat(this.clonesBefore,this.clonesAfter)},e.prototype.initEvents=function(){var t=this;this.nextButton&&this.nextButton.addEventListener("click",this.next.bind(this),!1),this.prevButton&&this.prevButton.addEventListener("click",this.prev.bind(this),!1);var e={},i={},s=function(s){i.x="mousemove"===s.type?s.clientX:s.touches[0].clientX,i.y="mousemove"===s.type?s.clientY:s.touches[0].clientY,t.delta.x=i.x-e.x,t.delta.y=i.y-e.y,t.updateItemsTranslate(t.delta.x)},n=function(){if(document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",n),document.removeEventListener("touchmove",s),document.removeEventListener("touchend",n),0!==t.delta.x){var e=Math.round(t.delta.x/t.itemWidth+.25*Math.sign(t.delta.x));t.track.classList.remove("is-grabbing");var i=t.settings.centerMode?t.currentItem:t.activeItemsStart;t.goTo(i-e),t.delta.x=0,t.delta.y=0}};this.settings.dragging&&this.track.addEventListener("mousedown",function(i){0===i.button&&(t.track.classList.add("is-grabbing"),i.preventDefault(),e.x=i.clientX,e.y=i.clientY,document.addEventListener("mousemove",s),document.addEventListener("mouseup",n))}),this.settings.touching&&this.track.addEventListener("touchstart",function(i){t.track.classList.add("is-grabbing"),i.preventDefault(),e.x=i.touches[0].clientX,e.y=i.touches[0].clientY,document.addEventListener("touchmove",s),document.addEventListener("touchend",n)}),this.settings.clicking&&(this.items.forEach(function(e,i){e.addEventListener("click",function(){return t.goTo(i)})}),this.settings.infiniteScroll&&(this.clonesAfter.forEach(function(e,i){e.addEventListener("click",function(){return t.goTo(i+t.itemsCount)})}),this.clonesBefore.forEach(function(e,i){e.addEventListener("click",function(){return t.goTo(i-t.itemsCount)})}))),window.addEventListener("resize",this.updateWidth.bind(this),!1)},e.prototype.updateWidth=function(){var t=this;this.containerWidth=this.el.offsetWidth,this.itemWidth=this.containerWidth/this.settings.itemsToShow,this.settings.centerMode&&(this.itemWidth=this.containerWidth/(this.settings.itemsToShow+.5)),this.allItems.forEach(function(e){e.style.width=t.itemWidth+"px"}),this.goTo(this.currentItem)},e.prototype.goTo=function(t,e){var i=this;void 0===e&&(e=!1),this.isSliding||(this.isSliding=!0,this.track.style.transition=this.settings.transitionTime/1e3+"s",this.allItems.forEach(function(t){t.style.transition=i.settings.transitionTime/1e3+"s"}),this.currentItem=this.settings.infiniteScroll?t:Math.min(Math.max(t,0),this.itemsCount-1),this.settings.controls&&!e&&this.settings.controls.goTo(this.currentItem,!0),this.settings.follows&&!e&&this.settings.follows.goTo(this.currentItem,!0),this.update(),setTimeout(function(){i.isSliding=!1,i.track.style.transition="",i.allItems.forEach(function(t){t.style.transition=""}),i.settings.infiniteScroll&&(i.currentItem=i.normalizeCurrentItemIndex(t),i.update())},this.settings.transitionTime))},e.prototype.next=function(){this.goTo(this.currentItem+this.settings.itemsToScroll)},e.prototype.prev=function(){this.goTo(this.currentItem-this.settings.itemsToScroll)},e.prototype.update=function(){this.updateItemsTranslate(),this.updateActiveItems(),this.updateItemsClasses()},e.prototype.updateActiveItems=function(){if(this.activeItemsStart=Math.min(this.currentItem,this.itemsCount-this.settings.itemsToShow),this.activeItemsEnd=this.currentItem+this.settings.itemsToShow,this.settings.centerMode){var t=Math.floor((this.settings.itemsToShow-1)/2);this.activeItemsStart=this.currentItem-t,this.activeItemsEnd-=t}!this.settings.centerMode&&this.settings.infiniteScroll&&(this.activeItemsStart=this.currentItem)},e.prototype.updateItemsTranslate=function(t){void 0===t&&(t=0);var e=0,i=0,s=Math.floor((this.settings.itemsToShow-1)/2),n=s+Math.floor((this.settings.itemsToShow-1)%2),o=this.itemsCount-this.settings.itemsToShow,r=Math.min(Math.max(this.currentItem,0),o);this.settings.centerMode&&(e=(s+.25)*this.itemWidth),this.settings.infiniteScroll&&(i=this.itemsCount*this.itemWidth,r=this.currentItem),this.settings.centerMode&&!this.settings.infiniteScroll&&(r=this.currentItem>this.itemsCount-1-n?this.itemsCount-1-n:this.currentItem,e=this.currentItem<s?(this.currentItem+.25)*this.itemWidth:e),this.transformX=r*-this.itemWidth-i+t+e,this.track.style.transform="translate3d("+this.transformX+"px, 0, 0)"},e.prototype.updateItemsClasses=function(){var t=this,e=this.settings.classes;this.allItems.forEach(function(t){return(i=t.classList).remove.apply(i,Object.values(e));var i}),this.addClass(this.currentItem,e.current),this.addClass(this.activeItemsStart-1,e.prev),this.addClass(this.activeItemsEnd,e.next);for(var i=this.activeItemsStart;i<this.activeItemsEnd;i++)t.addClass(i,e.active)},e.prototype.addClass=function(t,e){(t<0||t>=this.itemsCount)&&!this.settings.infiniteScroll||(t<0?this.clonesBefore[t+this.itemsCount].classList.add(e):t>=this.itemsCount?this.clonesAfter[t-this.itemsCount].classList.add(e):this.items[t].classList.add(e))},e.prototype.normalizeCurrentItemIndex=function(t){return t>=this.itemsCount?(t-=this.itemsCount,this.normalizeCurrentItemIndex(t)):t<0?(t+=this.itemsCount,this.normalizeCurrentItemIndex(t)):t},e});