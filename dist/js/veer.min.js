!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.Veer=e()}(this,function(){"use strict";function t(t){return"string"==typeof t?document.querySelector(t):t}var e=function(e,i){void 0===i&&(i={});var s=i.itemsToShow;void 0===s&&(s=1);var n=i.itemsToScroll;void 0===n&&(n=1);var o=i.infiniteScroll;void 0===o&&(o=!0);var r=i.centerMode;void 0===r&&(r=!1);var h=i.transitionTime;void 0===h&&(h=500);var a=i.controls;void 0===a&&(a=null);var c=i.drag;void 0===c&&(c=!0);var l=i.classes;void 0===l&&(l={active:"is-active",current:"is-current",prev:"is-prev",next:"is-next"}),this.el=t(e),this.settings={itemsToShow:s,itemsToScroll:n,infiniteScroll:o,centerMode:r,transitionTime:h,controls:a,drag:c,classes:l},this.init()};return e.prototype.init=function(){this.items=Array.from(this.el.querySelectorAll(':scope > *:not([class^="veer"])')),this.itemsCount=this.items.length,this.currentItem=0,this.itemWidth=0,this.clonesAfter=[],this.clonesBefore=[],this.containerWidth=0,this.track=null,this.nextButton=this.el.querySelector(".veer-next"),this.prevButton=this.el.querySelector(".veer-prev"),this.isSliding=!1,this.initWrapper(),this.initEvents(),this.settings.infiniteScroll&&this.initClones(),this.settings.controls&&(this.settings.controls.settings.follows=this),this.updateWidth()},e.prototype.initWrapper=function(){var t=this,e=document.createDocumentFragment();this.track=document.createElement("div"),this.track.classList.add("veer-track"),this.items.forEach(function(e,i){var s=document.createElement("div");s.classList.add("veer-item"),s.appendChild(e),t.items[i]=s,t.track.appendChild(s)}),e.appendChild(this.track),this.el.appendChild(e)},e.prototype.initClones=function(){var t=this,e=document.createDocumentFragment();this.items.forEach(function(i){var s=i.cloneNode(!0);s.classList.add("veer-clone"),t.clonesAfter.push(s),e.appendChild(s)}),this.track.appendChild(e);var i=document.createDocumentFragment();this.items.forEach(function(e){var s=e.cloneNode(!0);s.classList.add("veer-clone"),t.clonesBefore.push(s),i.appendChild(s)}),this.track.insertBefore(i,this.track.firstChild)},e.prototype.initEvents=function(){var t=this;this.nextButton&&this.nextButton.addEventListener("click",this.next.bind(this),!1),this.prevButton&&this.prevButton.addEventListener("click",this.prev.bind(this),!1),this.settings.drag&&(this.track.addEventListener("mousedown",function(e){if(0===e.button){var i={},s={};t.delta={x:0,y:0},t.track.classList.add("is-grabbing"),e.preventDefault(),i.x=e.clientX,i.y=e.clientY;var n=function(e){s.x=e.clientX,s.y=e.clientY,t.delta.x=s.x-i.x,t.delta.y=s.y-i.y,t.updateItemsTranslate(t.delta.x)},o=function(){var e=Math.floor((-t.delta.x+t.itemWidth/2)/t.itemWidth);t.track.classList.remove("is-grabbing"),t.goTo(t.currentItem+e),document.removeEventListener("mousemove",n),document.removeEventListener("mouseup",o)};document.addEventListener("mousemove",n),document.addEventListener("mouseup",o)}}),this.track.addEventListener("touchstart",function(e){console.log(e);var i={},s={};t.delta={},t.track.classList.add("is-grabbing"),e.preventDefault(),i.x=e.touches[0].clientX,i.y=e.touches[0].clientY;var n=function(e){s.x=e.touches[0].clientX,s.y=e.touches[0].clientY,t.delta.x=s.x-i.x,t.delta.y=s.y-i.y,t.updateItemsTranslate(t.delta.x)},o=function(){var e=Math.floor((-t.delta.x+t.itemWidth/2)/t.itemWidth);t.track.classList.remove("is-grabbing"),t.goTo(t.currentItem+e),document.removeEventListener("touchmove",n),document.removeEventListener("touchend",o)};document.addEventListener("touchmove",n),document.addEventListener("touchend",o)})),window.addEventListener("resize",this.updateWidth.bind(this),!1)},e.prototype.updateWidth=function(){var t=this;this.containerWidth=this.el.offsetWidth,this.itemWidth=this.containerWidth/this.settings.itemsToShow,this.settings.centerMode&&(this.itemWidth=this.containerWidth/(this.settings.itemsToShow+.5)),this.items.forEach(function(e){e.style.width=t.itemWidth+"px"}),this.clonesBefore.forEach(function(e){e.style.width=t.itemWidth+"px"}),this.clonesAfter.forEach(function(e){e.style.width=t.itemWidth+"px"}),this.goTo(this.currentItem)},e.prototype.goTo=function(t,e){var i=this;void 0===e&&(e=!1),this.isSliding||(this.isSliding=!0,this.track.style.transition=this.settings.transitionTime/1e3+"s",this.items.forEach(function(t){t.style.transition=i.settings.transitionTime/1e3+"s"}),this.clonesBefore.forEach(function(t){t.style.transition=i.settings.transitionTime/1e3+"s"}),this.clonesAfter.forEach(function(t){t.style.transition=i.settings.transitionTime/1e3+"s"}),this.currentItem=this.settings.infiniteScroll?t:Math.min(Math.max(t,0),this.itemsCount-1),this.updateItemsTranslate(),this.updateItemsClasses(),this.settings.controls&&!e&&this.settings.controls.goTo(this.currentItem,!0),this.settings.follows&&!e&&this.settings.follows.goTo(this.currentItem,!0),setTimeout(function(){i.isSliding=!1,i.track.style.transition="",i.items.forEach(function(t){t.style.transition=""}),i.clonesBefore.forEach(function(t){t.style.transition=""}),i.clonesAfter.forEach(function(t){t.style.transition=""}),i.settings.infiniteScroll&&(i.currentItem=i.normalizeCurrentItemIndex(t),i.updateItemsTranslate(),i.updateItemsClasses())},this.settings.transitionTime))},e.prototype.next=function(){this.goTo(this.currentItem+this.settings.itemsToScroll)},e.prototype.prev=function(){this.goTo(this.currentItem-this.settings.itemsToScroll)},e.prototype.updateItemsTranslate=function(t){void 0===t&&(t=0);var e=0,i=0,s=Math.floor((this.settings.itemsToShow-1)/2),n=s+Math.floor((this.settings.itemsToShow-1)%2),o=this.itemsCount-this.settings.itemsToShow,r=Math.min(Math.max(this.currentItem,0),o);this.settings.centerMode&&(e=(s+.25)*this.itemWidth),this.settings.infiniteScroll&&(i=this.itemsCount*this.itemWidth,r=this.currentItem),this.settings.centerMode&&!this.settings.infiniteScroll&&(r=this.currentItem>this.itemsCount-1-n?this.itemsCount-1-n:this.currentItem,e=this.currentItem<s?(this.currentItem+.25)*this.itemWidth:e),this.transformX=r*-this.itemWidth-i+t+e,this.track.style.transform="translate3d("+this.transformX+"px, 0, 0)"},e.prototype.updateItemsClasses=function(){var t=this,e=this.settings.classes;this.items.forEach(function(t){return(i=t.classList).remove.apply(i,Object.values(e));var i}),this.settings.infiniteScroll&&(this.clonesAfter.forEach(function(t){return(i=t.classList).remove.apply(i,Object.values(e));var i}),this.clonesBefore.forEach(function(t){return(i=t.classList).remove.apply(i,Object.values(e));var i}));var i=this.settings.infiniteScroll?this.currentItem:Math.min(this.currentItem,this.itemsCount-this.settings.itemsToShow),s=this.currentItem+this.settings.itemsToShow;if(this.settings.centerMode){var n=Math.floor((this.settings.itemsToShow-1)/2);i=this.currentItem-n,s-=n}this.addClass(this.currentItem,e.current),this.addClass(i-1,e.prev),this.addClass(s,e.next);for(var o=i;o<s;o++)t.addClass(o,e.active)},e.prototype.addClass=function(t,e){(t<0||t>=this.itemsCount)&&!this.settings.infiniteScroll||(t<0?this.clonesBefore[t+this.itemsCount].classList.add(e):t>=this.itemsCount?this.clonesAfter[t-this.itemsCount].classList.add(e):this.items[t].classList.add(e))},e.prototype.normalizeCurrentItemIndex=function(t){return t>=this.itemsCount?(t-=this.itemsCount,this.normalizeCurrentItemIndex(t)):t<0?(t+=this.itemsCount,this.normalizeCurrentItemIndex(t)):t},e});